---
title: "EDLD Winter 2020 Lab 2"
author: "Jim Wright; Claire Zhang"
date: "1/15/2020"
output: html_document
toc: true
toc_float: true
theme: united 
highlight: zenburn 
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(message = FALSE,
                      warning = FALSE,
                      echo = FALSE,
                      fig.width = 10,
                      fig.height = 10,
                      dev.args = list(bg="transparent"))

library(tidyverse)
library(here)
library(rio)
``` 


```{r load data, include = FALSE}

alcohol <- rio::import("https://github.com/fivethirtyeight/data/raw/master/alcohol-consumption/drinks.csv", 
                        setclass = "tbl_df")

head(alcohol)


``` 


# Data Exploration Histograms 
```{r plots, include=TRUE}

ggplot(alcohol, aes(beer_servings)) +
  geom_histogram(fill = "#56B4E9",
                 color = "white",
                 alpha = 0.9) +
  ggtitle("Bins = 30")

ggplot(alcohol, aes(beer_servings)) +
  geom_histogram(fill = "#56B4E9",
                 color = "white",
                 alpha = 0.9,
                 bins = 50) +
  ggtitle("bins = 50")

ggplot(alcohol, aes(beer_servings)) +
  geom_histogram(fill = "#56B4E9",
                 color = "white",
                 alpha = 0.9,
                 bins = 5) +
  ggtitle("Bins = 5")

ggplot(alcohol, aes(beer_servings)) +
  geom_histogram(fill = "#56B4E9",
                 color = "white",
                 alpha = 0.9,
                 bins = 25) +
  ggtitle("Bins = 25") +
  labs(x = "Beer Servings")
```

Jim: I believe the histogram of beer consumption with bins set at 25 is the superior option because the distribution is very positively skewed, so it provides a more clear explanation of how the lower end of the distribution varies. 

# Data Exploration Density Plots
```{r density plots, include=TRUE}
head(alcohol)

ggplot(alcohol, aes(wine_servings)) +
  geom_density()

ggplot(alcohol, aes(wine_servings)) +
  geom_density(fill = "#56B4E9",
               bw = 5) +
  ggtitle("BW = 5") +
  labs(x = "Wine Servings")

ggplot(alcohol, aes(wine_servings)) +
  geom_density(fill = "#56B4E9",
               bw = 0.5) +
  ggtitle("BW = 0.5") +
  labs(x = "Wine Servings")

ggplot(alcohol, aes(wine_servings)) +
  geom_density(fill = "#56B4E9",
               bw = 2) +
  ggtitle("BW = 2") +
  labs(x = "Wine Servings")

ggplot(alcohol, aes(wine_servings)) +
  geom_density(fill = "#56B4E9",
               bw = 10) +
  ggtitle("BW = 10") +
  labs(x = "Wine Servings")

ggplot(alcohol, aes(wine_servings)) +
  geom_density(fill = "#56B4E9",
               bw = 15) +
  ggtitle("BW = 15") +
  labs(x = "Wine Servings")

ggplot(alcohol, aes(wine_servings)) +
  geom_density(fill = "#56B4E9",
               bw = 20) +
  ggtitle("BW = 20") +
  labs(x = "Wine Servings")

```

Jim: I believe having a larger binwidth (10 - 20) is preferrable for the density plots because it more clearly displays the concentration of wine consumption at lower servings. Similar to beer consumption, wine consumption is skewed positivley, so I think it is better to provide a more clear display of where the largest display of consumption is occuring. 

# Data Reorganization 
```{r data reorganized, include=TRUE}
head(alcohol)

alcohol_pivot <- alcohol %>% 
  pivot_longer(beer_servings:wine_servings,
               names_to = "type",
               values_to = "servings")


ggplot(alcohol_pivot, aes(servings)) +
  geom_histogram(fill = "#A9E5C5",
                 color = "white",
                 alpha = 0.9,
                 bins = 5) +
  facet_wrap(~type)


ggplot(alcohol_pivot, aes(servings)) +
  geom_density(aes(fill = type),
               color = "white",
               alpha = 0.3,
               bw = 50) 

ggplot(alcohol_pivot, aes(servings, type)) +
  ggridges::geom_density_ridges(color = "white",
                                fill = "#A9E5C5")

```

Jim: All three plots suggest the distribution of alcohol consumption is positively skewed across all three types of alcohol: beer, spirts, and wine. At the lowest level of servings consumed, wine is the most often consumed type of alcohol, while at higher consumption rates, beer appears to be the drink of choice. 

# Reproduced Plot
```{r reproduced plot, include=TRUE}

?str_to_title

alcohol_pivot %>% 
  mutate(type = stringr::str_to_title(type)) %>% 
  arrange(desc(total_litres_of_pure_alcohol)) %>% 
  slice(1:(25*3)) %>% 
  ggplot(aes(country, servings)) +
  geom_col(fill = "#56B4E9", 
           alpha = 0.5) +
  coord_flip() +
  labs(x = "Country",
       y = "Proportion of total alcohol consumed",
       title = "Alcohol consumption by type",
       subtitle = "Top 25 countries displayed (according to total liters consumed")


alcohol_pivot %>% 
  mutate(type = stringr::str_to_title(type)) %>% 
  arrange(desc(total_litres_of_pure_alcohol)) %>% 
  slice(1:(25*3)) %>% 
  ggplot(aes(country, servings)) +
  geom_col(fill = "#56B4E9",
           alpha = 0.5) +
  coord_flip() +
  facet_wrap(~type) +
  labs(x = "Country",
       y = "Proportion of total alcohol consumed",
       title = "Alcohol consumption by type",
       subtitle = "Top 25 countries displayed (according to total liters consumed")
```
